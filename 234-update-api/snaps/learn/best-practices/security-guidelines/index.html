<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-snaps docs-version-current docs-doc-page docs-doc-id-learn/best-practices/security-guidelines" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Snaps security guidelines | MetaMask developer documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.metamask.io/234-update-api/snaps/learn/best-practices/security-guidelines/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:image" content="/img/metamaskog.jpeg"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-snaps-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-snaps-current"><meta data-rh="true" property="og:title" content="Snaps security guidelines | MetaMask developer documentation"><meta data-rh="true" name="description" content="Learn about best practices for creating secure and reliable Snaps."><meta data-rh="true" property="og:description" content="Learn about best practices for creating secure and reliable Snaps."><link data-rh="true" rel="icon" href="/234-update-api/img/metamask-fox.svg"><link data-rh="true" rel="canonical" href="https://docs.metamask.io/234-update-api/snaps/learn/best-practices/security-guidelines/"><link data-rh="true" rel="alternate" href="https://docs.metamask.io/234-update-api/snaps/learn/best-practices/security-guidelines/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metamask.io/234-update-api/snaps/learn/best-practices/security-guidelines/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AWX4QVM59R-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="MetaMask developer documentation" href="/234-update-api/opensearch.xml">




<link rel="preconnect" href="https://cdn.segment.io">
<script>!function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){if(window.analytics.initialized)return window.analytics[t].apply(window.analytics,arguments);var n=Array.prototype.slice.call(arguments);return n.unshift(t),e.push(n),e}};for(var t=0;t<e.methods.length;t++){var n=e.methods[t];e[n]=e.factory(n)}e.load=function(t,n){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(a,i),e._loadOptions=n},e._writeKey="wiHgKsAdU1z4onl1WWMhQmED4ma1VXEI",e.SNIPPET_VERSION="4.16.1",e.load("wiHgKsAdU1z4onl1WWMhQmED4ma1VXEI",{cookie:{sameSite:"None",secure:!0}}),e.page()}}()</script>

<script src="https://cmp.osano.com/AzZMxHTbQDOQD8c1J/a2e89f0e-f467-4542-bfea-30ea2c1a6648/osano.js"></script>
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="docs.metamask.io"></script>
<script src="/js/feedback-script.js" defer="defer" async></script>
<script src="/js/getfeedback.js" defer="defer" async></script><link rel="stylesheet" href="/234-update-api/assets/css/styles.3dfbb225.css">
<script src="/234-update-api/assets/js/runtime~main.83b7b368.js" defer="defer"></script>
<script src="/234-update-api/assets/js/main.8f0495fa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/234-update-api/"><div class="navbar__logo"><img src="/234-update-api/img/metamask-logo.svg" alt="MetaMask logo" class="themedComponent_mlkZ themedComponent--light_NVdE" width="150"><img src="/234-update-api/img/metamask-logo-dark.svg" alt="MetaMask logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="150"></div><b class="navbar__title text--truncate"> │ ‎ Documentation</b></a><a class="navbar__item navbar__link" href="/234-update-api/wallet/">Wallet</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/234-update-api/snaps/">Snaps</a><a class="navbar__item navbar__link" href="/234-update-api/services/">Services</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/234-update-api/whats-new/">What&#x27;s new?</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/234-update-api/snaps/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/234-update-api/snaps/get-started/">Get started</a><button aria-label="Collapse sidebar category &#x27;Get started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/get-started/install-flask/">Install MetaMask Flask</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/get-started/quickstart/">Snaps quickstart</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/234-update-api/snaps/learn/">Learn</a><button aria-label="Collapse sidebar category &#x27;Learn&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/learn/about-snaps/">About Snaps</a><button aria-label="Expand sidebar category &#x27;About Snaps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/learn/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/234-update-api/snaps/learn/best-practices/">Best practices</a><button aria-label="Collapse sidebar category &#x27;Best practices&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/learn/best-practices/design-guidelines/">Snaps design guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/234-update-api/snaps/learn/best-practices/security-guidelines/">Snaps security guidelines</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/learn/resources/">Resources</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/234-update-api/snaps/features/">Features</a><button aria-label="Collapse sidebar category &#x27;Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/cron-jobs/">Cron jobs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/features/custom-evm-accounts/">Custom EVM accounts</a><button aria-label="Expand sidebar category &#x27;Custom EVM accounts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item flaskOnly_MY7u"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/custom-name-resolution/">Custom name resolution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/features/custom-ui/">Custom UI</a><button aria-label="Expand sidebar category &#x27;Custom UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/data-storage/">Data storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/lifecycle-hooks/">Lifecycle hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/localization/">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/network-access/">Network access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/non-evm-networks/">Non-EVM networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/notifications/">Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item flaskOnly_MY7u"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/signature-insights/">Signature insights</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/static-files/">Static files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/features/transaction-insights/">Transaction insights</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/234-update-api/snaps/how-to/">How to</a><button aria-label="Collapse sidebar category &#x27;How to&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/request-permissions/">Request permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/communicate-errors/">Communicate errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/use-environment-variables/">Use environment variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/restrict-rpc-api/">Restrict RPC API methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/allow-automatic-connections/">Allow automatic connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/test-a-snap/">Test a Snap</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/how-to/debug-a-snap/">Debug a Snap</a><button aria-label="Expand sidebar category &#x27;Debug a Snap&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/publish-a-snap/">Publish a Snap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/get-allowlisted/">Get allowlisted</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/how-to/connect-to-a-snap/">Connect to a Snap</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/234-update-api/snaps/reference/">Reference</a><button aria-label="Collapse sidebar category &#x27;Reference&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/snaps-api/">Snaps API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/wallet-api-for-snaps/">Wallet API for Snaps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/reference/cli/">Snaps command line</a><button aria-label="Expand sidebar category &#x27;Snaps command line&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/entry-points/">Snaps entry points</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/permissions/">Snaps permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/known-errors/">Snaps known errors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/234-update-api/snaps/reference/keyring-api/">Keyring API</a><button aria-label="Expand sidebar category &#x27;Keyring API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/234-update-api/snaps/reference/jest/">Jest API and options</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><footer class="theme-doc-footer docusaurus-mt-lg margin-top--sm"></footer><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Snaps security guidelines</h1>
<p>This page outlines essential principles for builders to develop secure and reliable Snaps.
Use these guidelines when creating your Snap to ensure it is safe for users.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manage-permissions">Manage permissions<a href="#manage-permissions" class="hash-link" aria-label="Direct link to Manage permissions" title="Direct link to Manage permissions">​</a></h2>
<p>The following are guidelines for <a href="/234-update-api/snaps/how-to/request-permissions/">managing permissions</a> in the Snap manifest file.</p>
<ul>
<li>
<p><strong>Minimum permissions</strong> - Follow the principle of least authority by only adding the minimum
permissions needed by your Snap in the manifest file.
Before publishing your Snap, check the permissions again and remove any unused permissions.
You can validate your permissions using the <a href="https://metamask.github.io/snaps/snaps-simulator/staging/#/manifest" target="_blank" rel="noopener noreferrer">Snaps Simulator Manifest
Validator</a>.</p>
</li>
<li>
<p><strong>Minimum RPC access</strong> - When adding the <a href="/234-update-api/snaps/reference/permissions/#endowmentrpc"><code>endowment:rpc</code></a>
permission for Snaps or dapps, ask yourself if both are necessary.
For example, if permission is granted to communicate with Snaps, it means other Snaps can call
your Snap&#x27;s sensitive RPC methods.</p>
</li>
<li>
<p><strong>Minimum network access</strong> - Only add the <a href="/234-update-api/snaps/reference/permissions/#endowmentnetwork-access"><code>endowment:network-access</code></a>
permission if it&#x27;s absolutely necessary, such as when needing to communicate with a remote API
that is part of your Snap&#x27;s functionality.
This to mitigate users&#x27; concern about sharing wallet usage to remote servers.
If your Snap needs this permission, inform the user before communicating with remote servers and
include a privacy policy in your Snap that explains how data is shared.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="handle-transactions-securely">Handle transactions securely<a href="#handle-transactions-securely" class="hash-link" aria-label="Direct link to Handle transactions securely" title="Direct link to Handle transactions securely">​</a></h2>
<p>The following are guidelines for handling and signing transactions:</p>
<ul>
<li>
<p><strong>Transaction details</strong> - When handling transactions, provide a prompt displaying
all transaction details, including the receiver address, chain ID, network, and amount.
Display the originating site&#x27;s domain name and the target blockchain.
Ensure the user verifies the receiver address to avoid sending funds to an incorrect destination.</p>
</li>
<li>
<p><strong>Transparent signing</strong> - Display the message to be signed by the user in the Snap confirmation flow.
Do not rely on the requesting site to display this message, as it might choose not to, leading to the Snap signing the message silently.</p>
</li>
<li>
<p><strong>Consentful confirmations</strong> - Before signing a transaction, display a user confirmation prompt
with all the transaction details as previously mentioned.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="notify-users">Notify users<a href="#notify-users" class="hash-link" aria-label="Direct link to Notify users" title="Direct link to Notify users">​</a></h2>
<p>The following are guidelines for user notifications, dialogs, and authorizations:</p>
<ul>
<li>
<p><strong>Transparent and consentful actions</strong> - Before performing any of the following actions, display a
<a href="/234-update-api/snaps/features/custom-ui/dialogs/#display-a-confirmation-dialog">confirmation dialog</a> that
contains detailed information about the action and asks the user to reject or accept it:</p>
<ul>
<li><strong>Modifying or reading state.</strong> (In general, notify the user about any state changes.)</li>
<li><strong>Switching networks or accounts.</strong></li>
<li><strong>Deriving or generating key pairs, accounts, or smart contracts.</strong></li>
<li><strong>Signing transactions.</strong> (If your Snap is designed to allow automatic transactions, prompt the
user before enabling this and make sure they know how it works.
Also provide a way to disable it.)</li>
</ul>
</li>
<li>
<p><strong>Protect user keys</strong> - Do not allow your Snap to return all user wallet addresses to the
site, even public keys.
Users should choose and authorize the addresses to expose.</p>
</li>
<li>
<p><strong>Limit access to sensitive methods</strong> - When building a Snap with sensitive RPC methods,
use a companion dapp as an &quot;admin interface&quot; to interact with your Snap&#x27;s sensitive methods.
There are two ways to do this:</p>
<ol>
<li>
<p>Restrict the <a href="/234-update-api/snaps/reference/permissions/#endowmentrpc"><code>endowment:rpc</code></a> permission to specific
URLs using the <code>allowedOrigins</code> caveat.</p>
</li>
<li>
<p>Filter specific methods to specific URLs using the built-in <a href="https://developer.mozilla.org/en-US/docs/Web/API/URL" target="_blank" rel="noopener noreferrer">URL
library</a>:</p>
</li>
</ol>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> referrer </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">URL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">origin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">referrer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">protocol</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https:&quot;</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">referrer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">host</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">endsWith</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;.metamask.io&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> referrer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">host</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;metamask.io&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;URL is valid&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;URL is NOT valid&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the RPC method can be restricted when the origin matches <code>https://metamask.io</code>
or any subdomain.
This check can be used on any RPC method that should not be callable by all sites.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Avoid using regular expressions or string matching to filter URLs.
The URL library provides a much more reliable interface for matching URLs.</p></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="secure-sensitive-information">Secure sensitive information<a href="#secure-sensitive-information" class="hash-link" aria-label="Direct link to Secure sensitive information" title="Direct link to Secure sensitive information">​</a></h2>
<p>The following are guidelines for handling sensitive or personally identifiable information such as
user IPs, emails, passwords, and private keys:</p>
<ul>
<li>
<p><strong>Logging</strong> - Remove all logs to the JavaScript console that contain sensitive information.
Disable all logging before publishing your Snap.</p>
</li>
<li>
<p><strong>Errors</strong> - Review parts of your code where errors and exceptions can be raised.
In some cases, error stacks can be written to the console with sensitive information.
This information can be captured in data logs, or a malicious actor can phish the user into
copying and sending the error.</p>
</li>
<li>
<p><strong>Private keys</strong> - Avoid retrieving the user&#x27;s private key from the Snap unless
absolutely necessary, such as to sign a transaction.
If you only need the user&#x27;s public key, use <a href="/234-update-api/snaps/reference/snaps-api/#snap_getbip32publickey"><code>snap_getBip32PublicKey</code></a>
instead of deriving it from the private key.
Never return the private key in an RPC method to a dapp or another Snap.
To give users a way to view their private key, display it in a dialog.</p>
</li>
<li>
<p><strong>Limit exposure</strong> - Avoid accidentally returning sensitive information from a method.
For example, you might have a method that intends to return sensitive information only in specific
cases, but due to a typo or bad logic, it returns the information incorrectly, leaking data.
Even if you have a legitimate reason for allowing a user to export sensitive information, you
should prevent that information from being revealed carelessly (similar to how MetaMask makes it
difficult to reveal a Secret Recovery Phrase and for an observer looking over a user&#x27;s shoulder to
see it).</p>
</li>
</ul>
<p>When in doubt, choose friction over convenience for sensitive information.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="validate-parameters">Validate parameters<a href="#validate-parameters" class="hash-link" aria-label="Direct link to Validate parameters" title="Direct link to Validate parameters">​</a></h2>
<p>The following are guidelines for validating RPC parameters and handling values:</p>
<ul>
<li>
<p><strong>Validate user inputs</strong> - Validate and sanitize user inputs coming into the Snap-exposed RPC methods.
Never assume a parameter is safe to use.
If unvalidated user inputs are used inside the logic of your Snap methods, a dapp or a user can
exploit that logic in an unsafe way.</p>
</li>
<li>
<p><strong>Get values from MetaMask</strong> - Get values such as chain ID or address from MetaMask instead
of the dapp.
A dapp can accidentally or maliciously display incorrect values, tricking users into performing
certain actions (for example, signing a transaction for a network to which they didn&#x27;t intend to
broadcast the transaction).
If a dapp provides values that do not match the values from MetaMask, warn the user in your
confirmation flow.</p>
</li>
<li>
<p><strong>Use <code>copyable</code> for safe disclosures</strong> - When displaying arbitrary content in a Snap dialog, such
as for signing a message, use the <a href="/234-update-api/snaps/features/custom-ui/#copyable"><code>copyable</code></a> user
interface component instead of <code>text</code>.
When using dialogs, the input may contain special characters that render as Markdown and can
mislead the user.
For example:</p>
<img src="/234-update-api/assets/images/copyable-example-1-19ebcec288d171780516abf6c11460c2.png" alt="Example not using copyable with Markdown rendering" style="border:1px solid #DCDCDC">
<p>The special characters <code>*</code> and <code>_</code> render Markdown formatting, so what the user sees does not
match the content.
To avoid this, use <code>copyable</code> instead:</p>
<img src="/234-update-api/assets/images/copyable-example-2-619a18d7220bdfd794ad81f1c8f9d4ea.png" alt="Example using copyable with clean rendering" style="border:1px solid #DCDCDC">
<p><code>copyable</code> does not render Markdown and has the added benefit that the user can select to copy the content.
Also, the formatting provides a visual delineator to separate arbitrary input or fields from user
interface text.</p>
</li>
<li>
<p><strong>Check transaction data size</strong> - Check the size of the ABI-encoded transaction data&#x27;s function arguments.
The ABI specification requires all arguments, regardless of their type, to be 32 bytes.
If an argument is not 32 bytes, the calling contract&#x27;s behavior might depend on the contract
compiler version.
For example, Solidity 0.5.0 treats these non-aligned arguments as invalid and reverts the function call.
Older Solidity versions automatically append zeros at the end of the transaction data to ensure
all arguments are 32 bytes.
An attacker can exploit this feature to bypass security checks implemented in the corresponding
contract function that reads those function arguments.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-using-deprecated-methods">Avoid using deprecated methods<a href="#avoid-using-deprecated-methods" class="hash-link" aria-label="Direct link to Avoid using deprecated methods" title="Direct link to Avoid using deprecated methods">​</a></h2>
<p>Avoid using the following deprecated methods:</p>
<ul>
<li>
<p><code>wallet_enable</code>, which is deprecated in favor of
<a href="/234-update-api/snaps/reference/wallet-api-for-snaps/#wallet_requestsnaps"><code>wallet_requestSnaps</code></a>.</p>
</li>
<li>
<p><code>snap_confirm</code>, which is deprecated in favor of <a href="/234-update-api/snaps/reference/snaps-api/#snap_dialog"><code>snap_dialog</code></a>.</p>
</li>
<li>
<p><code>endowment:long-running</code>, which is deprecated for MetaMask stable but still allowed in MetaMask Flask.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="coding-best-practices">Coding best practices<a href="#coding-best-practices" class="hash-link" aria-label="Direct link to Coding best practices" title="Direct link to Coding best practices">​</a></h2>
<p>The following are coding security tips and warnings:</p>
<ul>
<li>
<p><strong>SES compatibility</strong> - Use packages or libraries compatible with SES (hardened JavaScript).
If you don&#x27;t, you might encounter errors that require <a href="/234-update-api/snaps/learn/how-to/debug-a-snap/common-issues.md/#patch-dependencies">patching a specific
dependency</a> to fix.</p>
</li>
<li>
<p><strong>Timers and side-channel attacks</strong> - Certain JavaScript features such as timers (for example,
<code>Date.now</code>) can expose critical system information, making a user vulnerable to
<a href="https://www.rambus.com/blogs/side-channel-attacks/" target="_blank" rel="noopener noreferrer">side-channel attacks</a>.
In the Snaps execution environment, the precision of these timers has been reduced to prevent this.</p>
</li>
<li>
<p><strong>Unsafe cryptographic libraries</strong> - Avoid using unsafe cryptographic libraries.
Do not use <code>Math.random</code>, which is not sufficiently random for generating cryptographic hashes and
can expose a user to reverse engineering or brute-forcing keys in the future.
Do not use insufficient hashing algorithms such as <code>md5</code> or <code>sha2</code>.
Do not roll your own cryptography or use custom or unproven cryptography methods or libraries.</p>
<p>We recommend using <a href="/234-update-api/snaps/reference/snaps-api/#snap_getentropy"><code>snap_getEntropy</code></a> for entropy, the
built-in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API" target="_blank" rel="noopener noreferrer">Web Crypto API</a> or
<a href="https://paulmillr.com/noble/" target="_blank" rel="noopener noreferrer">Noble cryptography libraries</a>, and safe hashing algorithms such as <code>sha256</code>.
Choose audited, widely used libraries over obscure, untested implementations.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manage-dependencies">Manage dependencies<a href="#manage-dependencies" class="hash-link" aria-label="Direct link to Manage dependencies" title="Direct link to Manage dependencies">​</a></h2>
<p>The following are guidelines for securing your supply chain:</p>
<ul>
<li>
<p><strong>Pin npm package dependencies</strong> - Pin all npm package dependencies in the Snap&#x27;s dependency tree
to exact versions.
If you don&#x27;t, a supply chain attacker can trick you into including a malicious version of a
package instead of the original, legitimate one.
You can quickly check the status of your dependencies by running <code>npm audit</code> in your Snap directory.</p>
</li>
<li>
<p><strong>Secure your stack</strong> - Your Snap companion dapp and any remote servers are part of your security model.
We recommend using <a href="https://github.com/LavaMoat/LavaMoat" target="_blank" rel="noopener noreferrer">LavaMoat</a> to secure relevant parts of
your stack and following security best practices for your dapp or server.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="publish-and-serve-your-snap">Publish and serve your Snap<a href="#publish-and-serve-your-snap" class="hash-link" aria-label="Direct link to Publish and serve your Snap" title="Direct link to Publish and serve your Snap">​</a></h2>
<p>The following are guidelines for making your Snap available to users safely:</p>
<ul>
<li>
<p><strong>Snap updates</strong> - When serving a Snap from a dapp, make sure users are getting the latest version
of your Snap.
Do not allow any actions on the dapp before reconnecting it to MetaMask and loading a new or
updated version of the Snap.
This prevents users from using outdated versions of the Snap that may have potential bugs and
security issues.</p>
</li>
<li>
<p><strong>Snap publication</strong> - Ensure correct publication of the Snap.
Only publish the <code>packages/snap</code> folder, and not the entire GitHub repository for a project.</p>
</li>
<li>
<p><strong>Other wallet extensions</strong> - Be aware that if the user has other wallet browser extensions
installed, a call to the MetaMask provider <code>window.ethereum</code> can be overridden.
<a href="https://github.com/MetaMask/snaps/discussions/2001" target="_blank" rel="noopener noreferrer">Connect to Snaps using EIP-6963</a> to reliably
access the MetaMask provider.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>In general, when developing Snaps, put yourself in the user&#x27;s shoes and consider how they use MetaMask.
Always prioritize their privacy and the security of their assets.</p>
<p>If you have any questions or a security best practice not listed here, post it in the
<a href="https://github.com/MetaMask/snaps/discussions" target="_blank" rel="noopener noreferrer">Snaps GitHub discussions</a>.</p></div><div class="getfeedback-container"><div ub-in-page="65299f6ab62d7120574ba82a"></div><div ub-in-page="6529a08f7a6d62001f19a79d"></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><div style="font-size:0.85rem"><a href="https://github.com/MetaMask/metamask-docs/edit/main/snaps/learn/best-practices/security-guidelines.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div><div class="col lastUpdated_VsjB"></div></div></footer></article></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#manage-permissions" class="table-of-contents__link toc-highlight">Manage permissions</a></li><li><a href="#handle-transactions-securely" class="table-of-contents__link toc-highlight">Handle transactions securely</a></li><li><a href="#notify-users" class="table-of-contents__link toc-highlight">Notify users</a></li><li><a href="#secure-sensitive-information" class="table-of-contents__link toc-highlight">Secure sensitive information</a></li><li><a href="#validate-parameters" class="table-of-contents__link toc-highlight">Validate parameters</a></li><li><a href="#avoid-using-deprecated-methods" class="table-of-contents__link toc-highlight">Avoid using deprecated methods</a></li><li><a href="#coding-best-practices" class="table-of-contents__link toc-highlight">Coding best practices</a></li><li><a href="#manage-dependencies" class="table-of-contents__link toc-highlight">Manage dependencies</a></li><li><a href="#publish-and-serve-your-snap" class="table-of-contents__link toc-highlight">Publish and serve your Snap</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/234-update-api/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/234-update-api/wallet/">MetaMask wallet</a></li><li class="footer__item"><a class="footer__link-item" href="/234-update-api/wallet/how-to/use-sdk/">MetaMask SDK</a></li><li class="footer__item"><a class="footer__link-item" href="/234-update-api/snaps/">Snaps</a></li><li class="footer__item"><a class="footer__link-item" href="/234-update-api/services/">Services</a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-extension/" target="_blank" rel="noopener noreferrer" class="footer__link-item">MetaMask wallet GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-sdk/" target="_blank" rel="noopener noreferrer" class="footer__link-item">MetaMask SDK GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/snaps-monorepo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Snaps GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/consensys" target="_blank" rel="noopener noreferrer" class="footer__link-item">Consensys Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-extension/blob/develop/docs/README.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribute to MetaMask<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-docs/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribute to the docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://consensys.net/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://consensys.net/terms-of-use/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://metamask.io/cla/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contributor License Agreement<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><button id="manage-cookie-btn">Manage cookies</button></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://metamask.io/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/234-update-api/img/metamask-logo.svg" alt="MetaMask logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="250"><img src="/234-update-api/img/metamask-logo-dark.svg" alt="MetaMask logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="250"></a></div><div class="footer__copyright">© 2024 MetaMask • A Consensys Formation</div></div></div></footer></div>
</body>
</html>