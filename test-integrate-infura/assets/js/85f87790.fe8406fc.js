"use strict";(self.webpackChunkmetamask_docs=self.webpackChunkmetamask_docs||[]).push([[31277],{64338:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var s=t(74848),i=t(28453);const r={description:"Send a transaction using Ethers."},a="Use ethers.js",c={id:"tutorials/ethereum/send-a-transaction/send-a-transaction-ethers",title:"Use ethers.js",description:"Send a transaction using Ethers.",source:"@site/services/tutorials/ethereum/send-a-transaction/send-a-transaction-ethers.md",sourceDirName:"tutorials/ethereum/send-a-transaction",slug:"/tutorials/ethereum/send-a-transaction/send-a-transaction-ethers",permalink:"/test-integrate-infura/services/tutorials/ethereum/send-a-transaction/send-a-transaction-ethers",draft:!1,unlisted:!1,editUrl:"https://github.com/MetaMask/metamask-docs/edit/main/services/tutorials/ethereum/send-a-transaction/send-a-transaction-ethers.md",tags:[],version:"current",frontMatter:{description:"Send a transaction using Ethers."}},o={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Steps",id:"steps",level:2},{value:"1. Create a project directory",id:"1-create-a-project-directory",level:3},{value:"2. install the dependencies",id:"2-install-the-dependencies",level:3},{value:"3. Create a .env file",id:"3-create-a-env-file",level:3},{value:"4. Create <code>eip1559_tx.js</code> file",id:"4-create-eip1559_txjs-file",level:3},{value:"5. Execute the transaction",id:"5-execute-the-transaction",level:3},{value:"6. Fine tune the transaction details (optional)",id:"6-fine-tune-the-transaction-details-optional",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"use-ethersjs",children:"Use ethers.js"}),"\n",(0,s.jsxs)(n.p,{children:["Send a regular transaction from one account to another with the ",(0,s.jsx)(n.a,{href:"https://docs.ethers.io/v5/",children:(0,s.jsx)(n.code,{children:"ethers.js"})})," JavaScript library."]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://nodejs.org/en/download/",children:"Node.js"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["An Ethereum account containing some ",(0,s.jsx)(n.a,{href:"https://www.infura.io/faucet",children:"Sepolia test ETH"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.a,{href:"https://metamask.io",children:"MetaMask"})," or similar to create an Ethereum account for testing."]})}),"\n",(0,s.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,s.jsx)(n.h3,{id:"1-create-a-project-directory",children:"1. Create a project directory"}),"\n",(0,s.jsx)(n.p,{children:"Create a new directory:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir infura\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"cd"})," into the directory:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd infura\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-install-the-dependencies",children:"2. install the dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install --save ethers\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-create-a-env-file",children:"3. Create a .env file"}),"\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.code,{children:".env"})," file in your project directory to store the project and Ethereum account details."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ETHEREUM_NETWORK = "sepolia"\nINFURA_API_KEY = "<API-KEY>"\nSIGNER_PRIVATE_KEY = "<PRIVATE-KEY>"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Ensure you replace the following values in the ",(0,s.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<API-KEY>"})," with the API key of the Web3 project."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<PRIVATE-KEY>"})," with the ",(0,s.jsx)(n.a,{href:"https://metamask.zendesk.com/hc/en-us/articles/360015289632-How-to-Export-an-Account-Private-Key",children:"private key of your Ethereum account"}),". A transaction must be signed with the sender's private key."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If using a network other than Sepolia, ensure you update ",(0,s.jsx)(n.code,{children:"ETHEREUM_NETWORK"})," with the network name."]}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsx)(n.p,{children:"Never disclose your private key. Anyone with your private keys can steal any assets held in your account."})}),"\n",(0,s.jsxs)(n.h3,{id:"4-create-eip1559_txjs-file",children:["4. Create ",(0,s.jsx)(n.code,{children:"eip1559_tx.js"})," file"]}),"\n",(0,s.jsxs)(n.p,{children:["In this example, we'll create a JavaScript file (",(0,s.jsx)(n.code,{children:"eip1559_tx.js"}),") in the project directory which configures and sends the transaction."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Replace ",(0,s.jsx)(n.code,{children:"to_account"})," with the relevant details."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'const { ethers } = require("ethers");\n\n    async function main() {\n      // Configuring the connection to an Ethereum node\n      const network = process.env.ETHEREUM_NETWORK;\n      const provider = new ethers.providers.InfuraProvider(\n        network,\n        process.env.INFURA_API_KEY\n      );\n      // Creating a signing account from a private key\n      const signer = new ethers.Wallet(process.env.SIGNER_PRIVATE_KEY, provider);\n\n      // Creating and sending the transaction object\n      const tx = await signer.sendTransaction({\n        to: "<to_account>",\n        value: ethers.utils.parseUnits("0.001", "ether"),\n      });\n      console.log("Mining transaction...");\n      console.log(`https://${network}.etherscan.io/tx/${tx.hash}`);\n      // Waiting for the transaction to be mined\n      const receipt = await tx.wait();\n      // The transaction is now on chain!\n      console.log(`Mined in block ${receipt.blockNumber}`);\n    }\n\n    require("dotenv").config();\n    main();\n'})}),"\n",(0,s.jsx)(n.h3,{id:"5-execute-the-transaction",children:"5. Execute the transaction"}),"\n",(0,s.jsx)(n.p,{children:"Run the script:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node eip1559_tx.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Mining transaction...\nhttps://sepolia.etherscan.io/tx/0x7c5c0061fbda9e01c1bb1269ffc7323107e2116d8f7327ee945aecc7c33d21c8\nMined in block 7587728\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can search for the transaction on a block explorer like ",(0,s.jsx)(n.a,{href:"https://www.infura.io/faucet",children:"Sepolia Etherscan"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"6-fine-tune-the-transaction-details-optional",children:"6. Fine tune the transaction details (optional)"}),"\n",(0,s.jsxs)(n.p,{children:["To change default values, update the ",(0,s.jsx)(n.code,{children:"signer.sendTransaction"})," method to include an ",(0,s.jsx)(n.code,{children:"estimateGas"})," result."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'const limit = provider.estimateGas({\n  from: signer.address,\n  to: "<to_address_goes_here>",\n  value: ethers.utils.parseUnits("0.001", "ether"),\n});\n\n// Creating and sending the transaction object\nconst tx = await signer.sendTransaction({\n  to: "<to_address_goes_here>",\n  value: ethers.utils.parseUnits("0.001", "ether"),\n  gasLimit: limit,\n  nonce: signer.getTransactionCount(),\n  maxPriorityFeePerGas: ethers.utils.parseUnits("2", "gwei"),\n  chainId: 3,\n});\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var s=t(96540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);