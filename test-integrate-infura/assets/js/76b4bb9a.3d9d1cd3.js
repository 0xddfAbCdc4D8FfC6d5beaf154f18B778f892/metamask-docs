"use strict";(self.webpackChunkmetamask_docs=self.webpackChunkmetamask_docs||[]).push([[60392],{40783:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var n=i(74848),r=i(28453);const s={description:"Tips on how to avoid rate limiting."},o="Avoid rate limiting",a={id:"api/networks/ethereum/how-to/avoid-rate-limiting",title:"Avoid rate limiting",description:"Tips on how to avoid rate limiting.",source:"@site/services/api/networks/ethereum/how-to/avoid-rate-limiting.md",sourceDirName:"api/networks/ethereum/how-to",slug:"/api/networks/ethereum/how-to/avoid-rate-limiting",permalink:"/test-integrate-infura/services/api/networks/ethereum/how-to/avoid-rate-limiting",draft:!1,unlisted:!1,editUrl:"https://github.com/MetaMask/metamask-docs/edit/main/services/api/networks/ethereum/how-to/avoid-rate-limiting.md",tags:[],version:"current",frontMatter:{description:"Tips on how to avoid rate limiting."},sidebar:"servicesSidebar",previous:{title:"How to",permalink:"/test-integrate-infura/services/api/networks/ethereum/how-to/"},next:{title:"Interact with ERC-20 tokens",permalink:"/test-integrate-infura/services/api/networks/ethereum/how-to/interact-with-erc-20-tokens"}},l={},c=[{value:"Notice rate limiting behavior?",id:"notice-rate-limiting-behavior",level:3},{value:"Tips to avoid rate limiting",id:"tips-to-avoid-rate-limiting",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"avoid-rate-limiting",children:"Avoid rate limiting"}),"\n",(0,n.jsx)(t.p,{children:"Infura applies rate limiting account-wide after exceeding the daily request limit or the number of requests per second."}),"\n",(0,n.jsx)(t.p,{children:"For rate limiting designed to protect our service in the event of an attack, Infura uses a combination of:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Source IP address."}),"\n",(0,n.jsx)(t.li,{children:"JSON-RPC method."}),"\n",(0,n.jsx)(t.li,{children:"API key."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Infura is constantly adjusting rate limits based on overall usage and possible abuse."}),"\n",(0,n.jsx)(t.p,{children:"Typically only aggressive use should experience rate limiting."}),"\n",(0,n.jsxs)(t.p,{children:["Customers running into rate limits are encouraged to ",(0,n.jsx)(t.a,{href:"https://www.infura.io/contact",children:"contact us"}),". We'll work with you to determine how best to avoid rate limits."]}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["Requests for archive data are more expensive and are therefore subject to different rate limits. ",(0,n.jsx)(t.a,{href:"/test-integrate-infura/services/api/networks/ethereum/concepts/archive-data#rate-limits",children:"Find out more"}),"."]})}),"\n",(0,n.jsx)(t.h3,{id:"notice-rate-limiting-behavior",children:"Notice rate limiting behavior?"}),"\n",(0,n.jsxs)(t.p,{children:["When you're rate limited, your JSON-RPC responses have HTTP status code ",(0,n.jsx)(t.code,{children:"429."})]}),"\n",(0,n.jsx)(t.p,{children:"They also contain a JSON-RPC error response with the reason for the rate limit. For example, if you use all the allowed daily requests:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "id": 1,\n  "error": {\n    "code": -32005,\n    "message": "daily request count exceeded, request rate limited"\n  }\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Or if you submit a higher number of requests per second than the maximum allowed limit:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "id": 1,\n  "error": {\n    "code": -32005,\n    "message": "project ID request rate exceeded",\n    "data": {\n      "see": "https://infura.io/docs/ethereum/jsonrpc/ratelimits",\n      "current_rps": 13.333,\n      "allowed_rps": 10.0,\n      "backoff_seconds": 30.0\n    }\n  }\n}\n'})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"data"})," array contains three fields related to rate limits:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"current_rps"})," - The current rate per second determined by Infura."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"allowed_rps"})," - The current ",(0,n.jsx)(t.em,{children:"allowed"})," rate which you should stay under."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"backoff_seconds"})," - The suggested amount of time to wait before sending more requests."]}),"\n"]}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["The value for ",(0,n.jsx)(t.code,{children:"allowed_rps"})," changes depending on overall network conditions; therefore consider the value for ",(0,n.jsx)(t.code,{children:"current_rps"})," valid and up-to-date."]})}),"\n",(0,n.jsx)(t.h3,{id:"tips-to-avoid-rate-limiting",children:"Tips to avoid rate limiting"}),"\n",(0,n.jsxs)(t.p,{children:["We recommend pausing JSON-RPC activity for the time value in ",(0,n.jsx)(t.code,{children:"backoff_seconds"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"If you're consistently rate limited, consider these workarounds:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Cache Ethereum data locally."})," Barring rare deep reorganizations of the chain, blocks more than a couple of blocks below the head of the chain can be cached indefinitely. Ask for the data once then keep it locally."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Limit RPCs at dapp startup."})," Likewise, limit the number of RPCs your dapp calls immediately at startup. Only request data as the user accesses that portion of the dapp, and cache anything from older blocks for next time."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Don't poll Infura in a tight loop."})," New blocks come roughly every 15 seconds, so requesting new data at a faster rate usually doesn't make sense. Consider using ",(0,n.jsx)(t.code,{children:"eth_subscribe"})," to be notified when new blocks are available."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["You can have Infura notify you when you're near your daily limit by selecting ",(0,n.jsx)(t.strong,{children:"Email Notifications"})," the ",(0,n.jsx)(t.strong,{children:"Accounts"})," tab\nof the Infura ",(0,n.jsx)(t.strong,{children:"Settings"}),". Infura sends emails when your daily requests reach 75%, 85%, and 100% of the allowed limit."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Example email"}),":"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(37832).A+"",width:"1176",height:"386"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},37832:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/emailexample-ec0b522f4bb2dbf3e375bacf1d2875ea.png"},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(96540);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);