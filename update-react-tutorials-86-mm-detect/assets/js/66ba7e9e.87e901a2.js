"use strict";(self.webpackChunkmetamask_docs=self.webpackChunkmetamask_docs||[]).push([[4050],{15680:(e,n,t)=>{t.d(n,{xA:()=>m,yg:()=>g});var a=t(96540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var o=a.createContext({}),p=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},m=function(e){var n=p(e.components);return a.createElement(o.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=p(t),c=i,g=u["".concat(o,".").concat(c)]||u[c]||d[c]||r;return t?a.createElement(g,s(s({ref:n},m),{},{components:t})):a.createElement(g,s({ref:n},m))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,s=new Array(r);s[0]=c;var l={};for(var o in n)hasOwnProperty.call(n,o)&&(l[o]=n[o]);l.originalType=e,l[u]="string"==typeof e?e:i,s[1]=l;for(var p=2;p<r;p++)s[p]=t[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},28004:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>m,contentTitle:()=>o,default:()=>g,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var a=t(58168),i=(t(96540),t(15680)),r=t(4865),s=t(19365);const l={description:"See the Snaps API reference.",sidebar_position:1},o="Snaps API",p={unversionedId:"reference/snaps-api",id:"reference/snaps-api",title:"Snaps API",description:"See the Snaps API reference.",source:"@site/snaps/reference/snaps-api.md",sourceDirName:"reference",slug:"/reference/snaps-api",permalink:"/update-react-tutorials-86-mm-detect/snaps/reference/snaps-api",draft:!1,editUrl:"https://github.com/MetaMask/metamask-docs/edit/main/snaps/reference/snaps-api.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{description:"See the Snaps API reference.",sidebar_position:1},sidebar:"snapsSidebar",previous:{title:"Reference",permalink:"/update-react-tutorials-86-mm-detect/snaps/reference"},next:{title:"Wallet API for Snaps",permalink:"/update-react-tutorials-86-mm-detect/snaps/reference/wallet-api-for-snaps"}},m={},u=[{value:"<code>snap_dialog</code>",id:"snap_dialog",level:2},{value:"Alert dialog",id:"alert-dialog",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Example",id:"example",level:4},{value:"Confirmation dialog",id:"confirmation-dialog",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"Returns",id:"returns",level:4},{value:"Example",id:"example-1",level:4},{value:"Prompt dialog",id:"prompt-dialog",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"Returns",id:"returns-1",level:4},{value:"Example",id:"example-2",level:4},{value:"<code>snap_getBip32Entropy</code>",id:"snap_getbip32entropy",level:2},{value:"Parameters",id:"parameters-3",level:4},{value:"Returns",id:"returns-2",level:4},{value:"Example",id:"example-3",level:4},{value:"<code>snap_getBip32PublicKey</code>",id:"snap_getbip32publickey",level:2},{value:"Parameters",id:"parameters-4",level:4},{value:"Returns",id:"returns-3",level:4},{value:"Example",id:"example-4",level:4},{value:"<code>snap_getBip44Entropy</code>",id:"snap_getbip44entropy",level:2},{value:"Parameters",id:"parameters-5",level:4},{value:"Returns",id:"returns-4",level:4},{value:"Example",id:"example-5",level:4},{value:"<code>snap_getClientStatus</code>",id:"snap_getclientstatus",level:2},{value:"Returns",id:"returns-5",level:4},{value:"Example",id:"example-6",level:4},{value:"<code>snap_getEntropy</code>",id:"snap_getentropy",level:2},{value:"Parameters",id:"parameters-6",level:4},{value:"Returns",id:"returns-6",level:4},{value:"Example",id:"example-7",level:4},{value:"<code>snap_getFile</code>",id:"snap_getfile",level:2},{value:"Parameters",id:"parameters-7",level:4},{value:"Returns",id:"returns-7",level:4},{value:"Example",id:"example-8",level:4},{value:"<code>snap_getLocale</code>",id:"snap_getlocale",level:2},{value:"Returns",id:"returns-8",level:4},{value:"Example",id:"example-9",level:4},{value:"<code>snap_manageAccounts</code>",id:"snap_manageaccounts",level:2},{value:"createAccount",id:"createaccount",level:3},{value:"Parameters",id:"parameters-8",level:4},{value:"Returns",id:"returns-9",level:4},{value:"Example",id:"example-10",level:4},{value:"updateAccount",id:"updateaccount",level:3},{value:"Parameters",id:"parameters-9",level:4},{value:"Returns",id:"returns-10",level:4},{value:"Example",id:"example-11",level:4},{value:"deleteAccount",id:"deleteaccount",level:3},{value:"Parameters",id:"parameters-10",level:4},{value:"Returns",id:"returns-11",level:4},{value:"Example",id:"example-12",level:4},{value:"listAccounts",id:"listaccounts",level:3},{value:"Returns",id:"returns-12",level:4},{value:"Example",id:"example-13",level:4},{value:"submitResponse",id:"submitresponse",level:3},{value:"Parameters",id:"parameters-11",level:4},{value:"Returns",id:"returns-13",level:4},{value:"Example",id:"example-14",level:4},{value:"<code>snap_manageState</code>",id:"snap_managestate",level:2},{value:"Parameters",id:"parameters-12",level:4},{value:"Returns",id:"returns-14",level:4},{value:"Example",id:"example-15",level:4},{value:"<code>snap_notify</code>",id:"snap_notify",level:2},{value:"Parameters",id:"parameters-13",level:4},{value:"Example",id:"example-16",level:4},{value:"Interactive UI methods",id:"interactive-ui-methods",level:2},{value:"<code>snap_createInterface</code>",id:"snap_createinterface",level:3},{value:"Parameters",id:"parameters-14",level:4},{value:"Returns",id:"returns-15",level:4},{value:"Example",id:"example-17",level:4},{value:"<code>snap_getInterfaceState</code>",id:"snap_getinterfacestate",level:3},{value:"Parameters",id:"parameters-15",level:4},{value:"Returns",id:"returns-16",level:4},{value:"Example",id:"example-18",level:4},{value:"<code>snap_updateInterface</code>",id:"snap_updateinterface",level:3},{value:"Parameters",id:"parameters-16",level:4},{value:"Example",id:"example-19",level:4}],d={toc:u},c="wrapper";function g(e){let{components:n,...t}=e;return(0,i.yg)(c,(0,a.A)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"snaps-api"},"Snaps API"),(0,i.yg)("p",null,"Snaps can communicate with and modify the functionality of MetaMask using the ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/learn/about-snaps/apis#snaps-api"},"Snaps API"),".\nTo call each method (except the ",(0,i.yg)("a",{parentName:"p",href:"#interactive-ui-methods"},"interactive UI methods"),"), you must first\n",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/how-to/request-permissions"},"request permission")," in the Snap manifest file."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"See the ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/wallet-api-for-snaps"},"Wallet API for Snaps")," for methods that dapps can call to\ncommunicate with Snaps.")),(0,i.yg)("h2",{id:"snap_dialog"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_dialog")),(0,i.yg)("p",null,"Displays a dialog in the MetaMask UI.\nThere are three types of dialogs with different parameters and return types: ",(0,i.yg)("a",{parentName:"p",href:"#alert-dialog"},"alert"),",\n",(0,i.yg)("a",{parentName:"p",href:"#confirmation-dialog"},"confirmation"),", and ",(0,i.yg)("a",{parentName:"p",href:"#prompt-dialog"},"prompt"),"."),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Dialogs do not work when MetaMask is locked. To check if MetaMask is locked, use ",(0,i.yg)("a",{parentName:"p",href:"#snap_getclientstatus"},(0,i.yg)("inlineCode",{parentName:"a"},"snap_getClientStatus")),".")),(0,i.yg)("h3",{id:"alert-dialog"},"Alert dialog"),(0,i.yg)("p",null,"Displays an alert that can only be acknowledged."),(0,i.yg)("h4",{id:"parameters"},"Parameters"),(0,i.yg)("p",null,"An object containing the contents of the alert dialog:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"type")," - The type of dialog (",(0,i.yg)("inlineCode",{parentName:"li"},'"alert"'),")."),(0,i.yg)("li",{parentName:"ul"},"One of:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"content")," - The content of the alert, as a ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/"},"custom UI")," component."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of an ",(0,i.yg)("a",{parentName:"li",href:"#snap_createinterface"},"interactive interface"),".")))),(0,i.yg)("h4",{id:"example"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'import { panel, text, heading } from "@metamask/snaps-sdk";\n\nawait snap.request({\n  method: "snap_dialog",\n  params: {\n    type: "alert",\n    content: panel([\n      heading("Something happened in the system"),\n      text("The thing that happened is..."),\n    ]),\n  },\n});\n\n// Code that should execute after the alert has been acknowledged.\n')),(0,i.yg)("h3",{id:"confirmation-dialog"},"Confirmation dialog"),(0,i.yg)("p",null,"Displays a confirmation that can be accepted or rejected."),(0,i.yg)("h4",{id:"parameters-1"},"Parameters"),(0,i.yg)("p",null,"An object containing the contents of the confirmation dialog:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"type")," - The type of dialog (",(0,i.yg)("inlineCode",{parentName:"li"},'"confirmation"'),")."),(0,i.yg)("li",{parentName:"ul"},"One of:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"content")," - The content of the confirmation, as a ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/"},"custom UI")," component."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of an ",(0,i.yg)("a",{parentName:"li",href:"#snap_createinterface"},"interactive interface"),".")))),(0,i.yg)("h4",{id:"returns"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"true")," if the confirmation was accepted, ",(0,i.yg)("inlineCode",{parentName:"p"},"false")," otherwise."),(0,i.yg)("h4",{id:"example-1"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'import { panel, text, heading } from "@metamask/snaps-sdk";\n\nconst result = await snap.request({\n  method: "snap_dialog",\n  params: {\n    type: "confirmation",\n    content: panel([\n      heading("Would you like to take the action?"),\n      text("The action is..."),\n    ]),\n  },\n});\n\nif (result === true) {\n  // Do the action.\n}\n')),(0,i.yg)("h3",{id:"prompt-dialog"},"Prompt dialog"),(0,i.yg)("p",null,"Displays a prompt where the user can enter a text response."),(0,i.yg)("h4",{id:"parameters-2"},"Parameters"),(0,i.yg)("p",null,"An object containing the contents of the prompt dialog:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"type")," - The type of dialog (",(0,i.yg)("inlineCode",{parentName:"li"},'"prompt"'),")."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"placeholder")," - Text that will be in the input field when nothing is typed."),(0,i.yg)("li",{parentName:"ul"},"One of:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"content")," - The content of the confirmation, as a ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/"},"custom UI")," component."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of an ",(0,i.yg)("a",{parentName:"li",href:"#snap_createinterface"},"interactive interface"),".")))),(0,i.yg)("h4",{id:"returns-1"},"Returns"),(0,i.yg)("p",null,"The text entered by the user if the prompt was submitted or ",(0,i.yg)("inlineCode",{parentName:"p"},"null")," if the prompt was rejected or closed. If the user does not enter any text and submits the prompt, the value is an empty string."),(0,i.yg)("h4",{id:"example-2"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'import { panel, text, heading } from "@metamask/snaps-sdk";\n\nconst walletAddress = await snap.request({\n  method: "snap_dialog",\n  params: {\n    type: "prompt",\n    content: panel([\n      heading("What is the wallet address?"),\n      text("Please enter the wallet address to be monitored"),\n    ]),\n    placeholder: "0x123...",\n  },\n});\n\n// walletAddress will be a string containing the address entered by the user.\n')),(0,i.yg)("h2",{id:"snap_getbip32entropy"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getBip32Entropy")),(0,i.yg)("admonition",{title:"important",type:"danger"},(0,i.yg)("p",{parentName:"admonition"},"If you call this method, you receive the user's parent key for the derivation path they request.\nYou're managing the user's keys and assets on their behalf.\nTheir safety is your responsibility.")),(0,i.yg)("p",null,"Gets the ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/satoshilabs/slips/blob/master/slip-0010.md"},"SLIP-10")," key for the ",(0,i.yg)("inlineCode",{parentName:"p"},"path"),"\nand ",(0,i.yg)("inlineCode",{parentName:"p"},"curve")," specified by the method name."),(0,i.yg)("p",null,"This method is designed to be used with the\n",(0,i.yg)("a",{parentName:"p",href:"https://npmjs.com/package/@metamask/key-tree"},(0,i.yg)("inlineCode",{parentName:"a"},"@metamask/key-tree"))," module.\n",(0,i.yg)("inlineCode",{parentName:"p"},"@metamask/key-tree")," can help you get the\n",(0,i.yg)("a",{parentName:"p",href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#extended-keys"},"extended private keys"),"\nfor user addresses, but it's your responsibility to know how to use those keys to, for example,\nderive an address for the relevant protocol or sign a transaction for the user."),(0,i.yg)("h4",{id:"parameters-3"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"path")," - An array, starting with ",(0,i.yg)("inlineCode",{parentName:"li"},"m"),", containing the BIP-32 derivation path to the key to\nretrieve.\nFor example, ",(0,i.yg)("inlineCode",{parentName:"li"},'["m", "44\'", "60\'"]'),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"curve")," - The curve to use for the key derivation.\nMust be ",(0,i.yg)("inlineCode",{parentName:"li"},'"ed25519"')," or ",(0,i.yg)("inlineCode",{parentName:"li"},'"secp256k1"'),".")),(0,i.yg)("h4",{id:"returns-2"},"Returns"),(0,i.yg)("p",null,"An object representing the\n",(0,i.yg)("a",{parentName:"p",href:"https://github.com/satoshilabs/slips/blob/master/slip-0010.md"},"SLIP-10")," HD tree node and containing\nits corresponding key material:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"depth")," - The 0-indexed path depth of the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"parentFingerprint")," - The fingerprint of the parent key, or 0 if this is a master node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"index")," - The index of the node, or 0 if this is a master node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"privateKey")," - The private key of the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"publicKey")," - The public key of the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"chainCode")," - The chain code of the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"curve")," - The name of the curve used by the node: ",(0,i.yg)("inlineCode",{parentName:"li"},'"ed25519"')," or ",(0,i.yg)("inlineCode",{parentName:"li"},'"secp256k1"'),".")),(0,i.yg)("h4",{id:"example-3"},"Example"),(0,i.yg)(r.A,{mdxType:"Tabs"},(0,i.yg)(s.A,{value:"Manifest file",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="snap.manifest.json"',title:'"snap.manifest.json"'},'"initialPermissions": {\n  "snap_getBip32Entropy": [\n    {\n      "path": ["m", "44\'", "3\'"],\n      "curve": "secp256k1" // Or "ed25519"\n    }\n  ]\n}\n'))),(0,i.yg)(s.A,{value:"JavaScript",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'import { SLIP10Node } from "@metamask/key-tree";\n\n// This example uses Dogecoin, which has a derivation path starting with m/44\'/3\'.\nconst dogecoinNode = await snap.request({\n  method: "snap_getBip32Entropy",\n  params: {\n    // The path and curve must be specified in the initial permissions.\n    path: ["m", "44\'", "3\'"],\n    curve: "secp256k1",\n  },\n});\n\n// Next, create an instance of a SLIP-10 node for the Dogecoin node.\nconst dogecoinSlip10Node = await SLIP10Node.fromJSON(dogecoinNode);\n\n// m/44\'/3\'/0\'\nconst accountKey0 = await dogecoinSlip10Node.derive(["bip32:0\'"]);\n\n// m/44\'/3\'/1\'\nconst accountKey1 = await dogecoinSlip10Node.derive(["bip32:1\'"]);\n\n// Now, you can ask the user to sign transactions, etc.\n')))),(0,i.yg)("h2",{id:"snap_getbip32publickey"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getBip32PublicKey")),(0,i.yg)("p",null,"Gets the ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki"},"BIP-32")," public key for the\nderivation path specified by the ",(0,i.yg)("inlineCode",{parentName:"p"},"path")," parameter.\nNote that this returns the public key, not the extended public key (",(0,i.yg)("inlineCode",{parentName:"p"},"xpub"),"), or Ethereum address."),(0,i.yg)("h4",{id:"parameters-4"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"path")," - An array, starting with ",(0,i.yg)("inlineCode",{parentName:"li"},"m"),", containing the BIP-32 derivation path to the public key to\nretrieve.\nFor example, ",(0,i.yg)("inlineCode",{parentName:"li"},'["m", "44\'", "60\'"]'),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"curve")," - The curve to use for the key derivation.\nMust be ",(0,i.yg)("inlineCode",{parentName:"li"},'"ed25519"')," or ",(0,i.yg)("inlineCode",{parentName:"li"},'"secp256k1"'),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"compressed")," - Indicates whether the public key should be compressed.\nThe default is ",(0,i.yg)("inlineCode",{parentName:"li"},"false"),".")),(0,i.yg)("h4",{id:"returns-3"},"Returns"),(0,i.yg)("p",null,"The public key as hexadecimal string."),(0,i.yg)("h4",{id:"example-4"},"Example"),(0,i.yg)(r.A,{mdxType:"Tabs"},(0,i.yg)(s.A,{value:"Manifest file",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="snap.manifest.json"',title:'"snap.manifest.json"'},'"initialPermissions": {\n  "snap_getBip32PublicKey": [\n    {\n      "path": ["m", "44\'", "3\'", "0\'", "0", "0"],\n      "curve": "secp256k1"\n    }\n  ]\n}\n'))),(0,i.yg)(s.A,{value:"JavaScript",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'// This example uses Dogecoin, which has a derivation path starting with m/44\'/3\'.\nconst dogecoinPublicKey = await snap.request({\n  method: "snap_getBip32PublicKey",\n  params: {\n    // The path and curve must be specified in the initial permissions.\n    path: ["m", "44\'", "3\'", "0\'", "0", "0"],\n    curve: "secp256k1",\n    compressed: false,\n  },\n});\n\n// "0x..."\nconsole.log(dogecoinPublicKey);\n')))),(0,i.yg)("h2",{id:"snap_getbip44entropy"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getBip44Entropy")),(0,i.yg)("admonition",{title:"important",type:"danger"},(0,i.yg)("p",{parentName:"admonition"},"If you call this method, you receive the user's parent key for the protocol they request.\nYou're managing the user's keys and assets on their behalf.\nTheir safety is your responsibility.")),(0,i.yg)("p",null,"Gets the ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki"},"BIP-44")," ",(0,i.yg)("inlineCode",{parentName:"p"},"coin_type")," key\nfor the ",(0,i.yg)("inlineCode",{parentName:"p"},"coin_type")," number specified by the method name.\nSee ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/satoshilabs/slips/blob/master/slip-0044.md"},"SLIP-44")," for the list of\navailable protocols and their ",(0,i.yg)("inlineCode",{parentName:"p"},"coin_type")," values."),(0,i.yg)("p",null,"This method is designed to be used with the\n",(0,i.yg)("a",{parentName:"p",href:"https://npmjs.com/package/@metamask/key-tree"},(0,i.yg)("inlineCode",{parentName:"a"},"@metamask/key-tree"))," module.\n",(0,i.yg)("inlineCode",{parentName:"p"},"@metamask/key-tree")," can help you get the\n",(0,i.yg)("a",{parentName:"p",href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#extended-keys"},"extended private keys"),"\nfor user addresses, but it's your responsibility to know how to use those keys to, for example,\nderive an address for the relevant protocol or sign a transaction for the user."),(0,i.yg)("h4",{id:"parameters-5"},"Parameters"),(0,i.yg)("p",null,"An object containing ",(0,i.yg)("inlineCode",{parentName:"p"},"coinType"),", the BIP-44 coin type to get the entropy for."),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Coin type 60 is reserved for MetaMask externally owned accounts and blocked for Snaps.\nIf you wish to connect to MetaMask accounts in a Snap, use\n",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/permissions/#endowmentethereum-provider"},(0,i.yg)("inlineCode",{parentName:"a"},"endowment:ethereum-provider"))," and\n",(0,i.yg)("a",{parentName:"p",href:"/wallet/reference/eth_requestAccounts"},(0,i.yg)("inlineCode",{parentName:"a"},"eth_requestAccounts")),".")),(0,i.yg)("h4",{id:"returns-4"},"Returns"),(0,i.yg)("p",null,"An object representing the\n",(0,i.yg)("a",{parentName:"p",href:"https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki"},"BIP-44")," ",(0,i.yg)("inlineCode",{parentName:"p"},"coin_type")," HD tree node\nand containing its corresponding key material:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"coin_type")," - The BIP-44 ",(0,i.yg)("a",{parentName:"li",href:"https://github.com/satoshilabs/slips/blob/master/slip-0044.md"},"coin type"),"\nvalue of the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"depth")," - The 0-indexed BIP-44 path depth of the node.\nSince this is a ",(0,i.yg)("inlineCode",{parentName:"li"},"coin_type")," node, the depth is ",(0,i.yg)("inlineCode",{parentName:"li"},"2"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"privateKey")," - The hexadecimal-encoded string representation of the private key for the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"publicKey")," - The hexadecimal-encoded string representation of the public key for the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"chainCode")," - The hexadecimal-encoded string representation of the chain code for the node."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"path")," - A human-readable representation of the BIP-44 HD tree path of the node.\nSince this is a ",(0,i.yg)("inlineCode",{parentName:"li"},"coin_type")," node, the path is of the form ",(0,i.yg)("inlineCode",{parentName:"li"},"m/44'/coin_type'"),".")),(0,i.yg)("h4",{id:"example-5"},"Example"),(0,i.yg)(r.A,{mdxType:"Tabs"},(0,i.yg)(s.A,{value:"Manifest file",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="snap.manifest.json"',title:'"snap.manifest.json"'},'"initialPermissions": {\n  "snap_getBip44Entropy": [\n    {\n      "coinType": 3\n    }\n  ]\n}\n'))),(0,i.yg)(s.A,{value:"JavaScript",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},"import { getBIP44AddressKeyDeriver } from \"@metamask/key-tree\";\n\n// This example uses Dogecoin, which has coin_type 3.\nconst dogecoinNode = await snap.request({\n  method: \"snap_getBip44Entropy\",\n  params: {\n    coinType: 3,\n  },\n});\n\n// Next, create an address key deriver function for the Dogecoin coin_type node.\n// In this case, its path is: m/44'/3'/0'/0/address_index\nconst deriveDogecoinAddress = await getBIP44AddressKeyDeriver(dogecoinNode);\n\n// These are BIP-44 nodes containing the extended private keys for the respective derivation paths.\n\n// m/44'/3'/0'/0/0\nconst addressKey0 = await deriveDogecoinAddress(0);\n\n// m/44'/3'/0'/0/1\nconst addressKey1 = await deriveDogecoinAddress(1);\n\n// Now, you can ask the user to sign transactions, etc.\n")))),(0,i.yg)("h2",{id:"snap_getclientstatus"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getClientStatus")),(0,i.yg)("p",null,"Gets the locked status of the Snaps client."),(0,i.yg)("p",null,"It is useful to check if MetaMask is locked in the following situations:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"When running background operations that require MetaMask to be unlocked, for example,\n",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/data-storage#2-use-encrypted-storage"},"accessing encrypted state"),".\nIf MetaMask is locked, the user gets an unexpected password request."),(0,i.yg)("li",{parentName:"ul"},"When ",(0,i.yg)("a",{parentName:"li",href:"#snap_dialog"},"displaying a dialog"),". Dialogs do not work when MetaMask is locked.")),(0,i.yg)("h4",{id:"returns-5"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"true")," if MetaMask is locked, ",(0,i.yg)("inlineCode",{parentName:"p"},"false")," if MetaMask is unlocked."),(0,i.yg)("h4",{id:"example-6"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.js"',title:'"index.js"'},'import type { OnCronjobHandler } from "@metamask/snaps-sdk";\nimport { MethodNotFoundError } from "@metamask/snaps-sdk";\n\nexport const onCronjob: OnCronjobHandler = async ({ request }) => {\n  switch (request.method) {\n    case "execute":\n      // Find out if MetaMask is locked.\n      const { locked } = await snap.request({\n        method: "snap_getClientStatus"\n      });\n\n      if (!locked) {\n        // Do something that requires MetaMask to be unlocked, such as access encrypted state.\n      }\n\n    default:\n      throw new MethodNotFoundError();\n  }\n};\n')),(0,i.yg)("h2",{id:"snap_getentropy"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getEntropy")),(0,i.yg)("p",null,"Gets a deterministic 256-bit entropy value, specific to the Snap and the user's account.\nYou can use this entropy to generate a private key, or any other value that requires a high level of\nrandomness.\nOther Snaps can't access this entropy, and it changes if the user's secret recovery phrase changes."),(0,i.yg)("p",null,"You can optionally specify a salt to generate different entropy for different purposes.\nUsing a salt results in entropy unrelated to the entropy generated without a salt."),(0,i.yg)("p",null,"This value is deterministic: it's always the same for the same Snap, user account, and salt."),(0,i.yg)("h4",{id:"parameters-6"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"version")," - The number ",(0,i.yg)("inlineCode",{parentName:"li"},"1"),".\nThis is reserved for future use."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"salt")," (optional) - An arbitrary string to be used as a salt for the entropy.\nThis can be used to generate different entropy for different purposes.")),(0,i.yg)("h4",{id:"returns-6"},"Returns"),(0,i.yg)("p",null,"The entropy as a hexadecimal string."),(0,i.yg)("h4",{id:"example-7"},"Example"),(0,i.yg)(r.A,{mdxType:"Tabs"},(0,i.yg)(s.A,{value:"Manifest file",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="snap.manifest.json"',title:'"snap.manifest.json"'},'"initialPermissions": {\n  "snap_getEntropy": {}\n}\n'))),(0,i.yg)(s.A,{value:"JavaScript",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'const entropy = await snap.request({\n  method: "snap_getEntropy",\n  params: {\n    version: 1,\n    salt: "foo", // Optional.\n  },\n});\n\n// "0x..."\nconsole.log(entropy);\n')))),(0,i.yg)("h2",{id:"snap_getfile"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getFile")),(0,i.yg)("p",null,"Gets a static file's content in UTF-8, Base64, or hexadecimal.\nThe file must be ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/static-files"},"specified in the Snap's manifest file"),"."),(0,i.yg)("h4",{id:"parameters-7"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"path")," - The path to the file, relative to the Snap's package directory (that is, one level above ",(0,i.yg)("inlineCode",{parentName:"li"},"src"),")."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"encoding")," (optional) - One of ",(0,i.yg)("inlineCode",{parentName:"li"},"utf8"),", ",(0,i.yg)("inlineCode",{parentName:"li"},"base64"),", or ",(0,i.yg)("inlineCode",{parentName:"li"},"hex"),". The default is ",(0,i.yg)("inlineCode",{parentName:"li"},"base64"),".")),(0,i.yg)("h4",{id:"returns-7"},"Returns"),(0,i.yg)("p",null,"The file content as a string in the requested encoding."),(0,i.yg)("h4",{id:"example-8"},"Example"),(0,i.yg)(r.A,{mdxType:"Tabs"},(0,i.yg)(s.A,{value:"Manifest file",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json",metastring:'title="snap.manifest.json"',title:'"snap.manifest.json"'},'"source": {\n  "shasum": "xxx",\n  "location": {\n    // ...\n  },\n  "files": [\n    "./files/myfile.bin"\n  ]\n}\n'))),(0,i.yg)(s.A,{value:"JavaScript",mdxType:"TabItem"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'const contents = await snap.request({\n  method: "snap_getFile",\n  params: {\n    path: "./files/myfile.bin",\n    encoding: "hex",\n  },\n});\n\n// "0x..."\nconsole.log(contents);\n')))),(0,i.yg)("h2",{id:"snap_getlocale"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_getLocale")),(0,i.yg)("p",null,"Gets the user's locale setting. You can use this method to localize text in your snap."),(0,i.yg)("h4",{id:"returns-8"},"Returns"),(0,i.yg)("p",null,"The user's locale setting as a ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/MetaMask/metamask-extension/blob/develop/app/_locales/index.json"},"language code"),"."),(0,i.yg)("h4",{id:"example-9"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'import { panel, text } from "@metamask/snaps-sdk";\n\nconst locale = await snap.request({ method: "snap_getLocale" });\n\nlet greeting = "Hello";\nif(locale === "es") {\n  greeting = "Hola";\n}\n\nawait snap.request({\n  method: "snap_dialog",\n  params: {\n    type: "alert",\n    content: panel([\n      text(greeting),\n    ]),\n  },\n});\n')),(0,i.yg)("h2",{id:"snap_manageaccounts"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_manageAccounts")),(0,i.yg)("p",null,"Manages ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-evm-accounts/"},"account management Snap")," accounts.\nThis method is organized into multiple sub-methods which each take their own parameters:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"#createaccount"},(0,i.yg)("inlineCode",{parentName:"a"},"createAccount"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"#updateaccount"},(0,i.yg)("inlineCode",{parentName:"a"},"updateAccount"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"#deleteaccount"},(0,i.yg)("inlineCode",{parentName:"a"},"deleteAccount"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"#listaccounts"},(0,i.yg)("inlineCode",{parentName:"a"},"listAccounts"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"#submitresponse"},(0,i.yg)("inlineCode",{parentName:"a"},"submitResponse")))),(0,i.yg)("h3",{id:"createaccount"},"createAccount"),(0,i.yg)("p",null,"Creates a new Snap account."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The Snap is responsible for maintaining its own record of accounts.\nThis can be done using ",(0,i.yg)("a",{parentName:"p",href:"#snap_managestate"},(0,i.yg)("inlineCode",{parentName:"a"},"snap_manageState")),".")),(0,i.yg)("h4",{id:"parameters-8"},"Parameters"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"account")," - ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/keyring-api/account-management/objects#keyringaccount"},"An account object.")),(0,i.yg)("h4",{id:"returns-9"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"null")),(0,i.yg)("h4",{id:"example-10"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.ts"',title:'"index.ts"'},'import { Keyring, KeyringAccount } from "@metamask/keyring-api";\n\nclass MyKeyring implements Keyring {\n  // Other methods.\n\n  async createAccount(\n    name: string,\n    options: Record<string, Json> | null = null,\n  ): Promise<KeyringAccount> {\n\n    const account: KeyringAccount = {\n      id: uuid(),\n      name,\n      options,\n      address,\n      supportedMethods: [\n        "eth_sendTransaction",\n        "eth_sign",\n        "eth_signTransaction",\n        "eth_signTypedData_v1",\n        "eth_signTypedData_v2",\n        "eth_signTypedData_v3",\n        "eth_signTypedData_v4",\n        "eth_signTypedData",\n        "personal_sign",\n      ],\n      type: "eip155:eoa",\n    };\n\n    // Store the account in state.\n\n    await snap.request({\n      method: "snap_manageAccounts",\n      params: {\n        method: "createAccount",\n        params: { account },\n      },\n    });\n\n    return account;\n  }\n}\n')),(0,i.yg)("h3",{id:"updateaccount"},"updateAccount"),(0,i.yg)("p",null,"Updates an existing Snap account."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The Snap is responsible for maintaining its own record of accounts.\nThis can be done using ",(0,i.yg)("a",{parentName:"p",href:"#snap_managestate"},(0,i.yg)("inlineCode",{parentName:"a"},"snap_manageState")),".")),(0,i.yg)("h4",{id:"parameters-9"},"Parameters"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"account")," - ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/keyring-api/account-management/objects#keyringaccount"},"An account object.")),(0,i.yg)("h4",{id:"returns-10"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"null")),(0,i.yg)("h4",{id:"example-11"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.ts"',title:'"index.ts"'},'import { Keyring, KeyringAccount } from "@metamask/keyring-api";\n\nclass MyKeyring implements Keyring {\n  // Other methods.\n\n  async updateAccount(account: KeyringAccount): Promise<void> {\n    // Store the new account details in state.\n\n    await snap.request({\n      method: "snap_manageAccounts",\n      params: {\n        method: "updateAccount",\n        params: { account },\n      },\n    });\n  }\n}\n')),(0,i.yg)("h3",{id:"deleteaccount"},"deleteAccount"),(0,i.yg)("p",null,"Deletes a Snap account."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The Snap is responsible for maintaining its own record of accounts.\nThis can be done using ",(0,i.yg)("a",{parentName:"p",href:"#snap_managestate"},(0,i.yg)("inlineCode",{parentName:"a"},"snap_manageState")),".")),(0,i.yg)("h4",{id:"parameters-10"},"Parameters"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"id")," - The ID of the account to be deleted."),(0,i.yg)("h4",{id:"returns-11"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"null")),(0,i.yg)("h4",{id:"example-12"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.ts"',title:'"index.ts"'},'import { Keyring } from "@metamask/keyring-api";\n\nclass MyKeyring implements Keyring {\n  // Other methods.\n\n  async deleteAccount(id: string): Promise<void> {\n    // Delete the account from state.\n\n    await snap.request({\n      method: "snap_manageAccounts",\n      params: {\n        method: "deleteAccount",\n        params: { id },\n      },\n    });\n  }\n}\n')),(0,i.yg)("h3",{id:"listaccounts"},"listAccounts"),(0,i.yg)("p",null,"Lists the calling Snap's accounts that are known to MetaMask.\nThis method does not call back to the Snap.\nInstead, the Snap can use it to check whether there's a discrepancy between the Snap's internal\nstate of accounts and the state known to MetaMask."),(0,i.yg)("h4",{id:"returns-12"},"Returns"),(0,i.yg)("p",null,"An array of ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/keyring-api/account-management/objects#keyringaccount"},"account objects"),"."),(0,i.yg)("h4",{id:"example-13"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.ts"',title:'"index.ts"'},'import { Keyring, KeyringAccount } from "@metamask/keyring-api";\n\nclass MyKeyring implements Keyring {\n  // Other methods.\n\n  async checkIfAccountsInSync(): Promise<boolean> {\n\n    const knownAccounts: KeyringAccount[] = /* Grab accounts from Snap state. */;\n\n    const listedAccounts: KeyringAccount[] = await snap.request({\n      method: "snap_manageAccounts",\n      params: {\n        method: "listAccounts",\n      },\n    });\n\n    // Compare the arrays and return the response.\n  }\n}\n')),(0,i.yg)("h3",{id:"submitresponse"},"submitResponse"),(0,i.yg)("p",null,"Finalizes a signing request.\nThis is usually called as part of the\n",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/keyring-api/account-management/#keyring_approverequest"},(0,i.yg)("inlineCode",{parentName:"a"},"keyring_approveRequest"))," method."),(0,i.yg)("h4",{id:"parameters-11"},"Parameters"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of the request to finalize."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"result")," - The result that should be returned to the original JSON-RPC caller.")),(0,i.yg)("h4",{id:"returns-13"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"null")),(0,i.yg)("h4",{id:"example-14"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript",metastring:'title="index.ts"',title:'"index.ts"'},'import { Keyring } from "@metamask/keyring-api";\nimport { Json } from "@metamask/utils";\n\nclass MyKeyring implements Keyring {\n  // Other methods.\n\n  async approveRequest(id: string, result?: Json): Promise<void> {\n    // Do any Snap-side logic to finish approving the request.\n\n    await snap.request({\n      method: "snap_manageAccounts",\n      params: {\n        method: "submitResponse",\n        params: { id, result },\n      },\n    });\n  }\n}\n')),(0,i.yg)("h2",{id:"snap_managestate"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_manageState")),(0,i.yg)("p",null,"Allows the Snap to persist up to 100 MB of data to disk and retrieve it at will.\nBy default, the data is automatically encrypted using a Snap-specific key and automatically\ndecrypted when retrieved.\nYou can set ",(0,i.yg)("inlineCode",{parentName:"p"},"encrypted")," to ",(0,i.yg)("inlineCode",{parentName:"p"},"false")," to use unencrypted storage."),(0,i.yg)("h4",{id:"parameters-12"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"operation")," - The state operation to perform (",(0,i.yg)("inlineCode",{parentName:"li"},'"clear"'),", ",(0,i.yg)("inlineCode",{parentName:"li"},'"get"'),", or ",(0,i.yg)("inlineCode",{parentName:"li"},'"update"'),")."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"newState")," - The value to update state with if the operation is ",(0,i.yg)("inlineCode",{parentName:"li"},'"update"'),", and nothing otherwise."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"encrypted")," (optional) - Indicates whether the Snap will encrypt the data.\nThe default is ",(0,i.yg)("inlineCode",{parentName:"li"},"true"),".")),(0,i.yg)("h4",{id:"returns-14"},"Returns"),(0,i.yg)("p",null,"The value stored in state if the operation is ",(0,i.yg)("inlineCode",{parentName:"p"},"get"),", and ",(0,i.yg)("inlineCode",{parentName:"p"},"null")," otherwise."),(0,i.yg)("h4",{id:"example-15"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'// Persist some data.\nawait snap.request({\n  method: "snap_manageState",\n  params: { \n    operation: "update",\n    newState: { hello: "world" },\n  },\n});\n\n// At a later time, get the stored data.\nconst persistedData = await snap.request({\n  method: "snap_manageState",\n  params: { operation: "get" },\n});\n\nconsole.log(persistedData);\n// { hello: "world" }\n\n// If there\'s no need to store data anymore, clear it out.\nawait snap.request({\n  method: "snap_manageState",\n  params: { \n    operation: "clear",\n  },\n});\n')),(0,i.yg)("h2",{id:"snap_notify"},(0,i.yg)("inlineCode",{parentName:"h2"},"snap_notify")),(0,i.yg)("p",null,"Displays a notification in MetaMask or natively in the browser.\nSnaps can trigger a short notification text for actionable or time sensitive information."),(0,i.yg)("admonition",{title:"Notification rate limits",type:"info"},(0,i.yg)("p",{parentName:"admonition"},"The ability for Snaps to trigger notifications is rate-limited to:"),(0,i.yg)("ul",{parentName:"admonition"},(0,i.yg)("li",{parentName:"ul"},"2 native notifications per 5 minutes per Snap."),(0,i.yg)("li",{parentName:"ul"},"5 in-app notifications per minute per Snap."))),(0,i.yg)("h4",{id:"parameters-13"},"Parameters"),(0,i.yg)("p",null,"An object containing the contents of the notification:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"type")," - The notification type.\nSpecify ",(0,i.yg)("inlineCode",{parentName:"li"},"inApp")," to display the notification in the MetaMask UI, and ",(0,i.yg)("inlineCode",{parentName:"li"},"native")," to display the\nnotification in the browser.\nWe recommend using ",(0,i.yg)("inlineCode",{parentName:"li"},"inApp")," because there's no guarantee that native notifications are displayed to\nthe user."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"message")," - A message to show in the notification.")),(0,i.yg)("h4",{id:"example-16"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'},'await snap.request({\n  method: "snap_notify",\n  params: {\n    type: "inApp",\n    message: "Hello, world!",\n  },\n});\n')),(0,i.yg)("h2",{id:"interactive-ui-methods"},"Interactive UI methods"),(0,i.yg)("p",null,"The following methods are used in ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/interactive-ui"},"interactive UI"),".\nThese methods do not require requesting permission in the Snap manifest file."),(0,i.yg)("h3",{id:"snap_createinterface"},(0,i.yg)("inlineCode",{parentName:"h3"},"snap_createInterface")),(0,i.yg)("admonition",{type:"flaskOnly"}),(0,i.yg)("p",null,"Creates an interactive interface for use in ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/interactive-ui"},"interactive UI"),"."),(0,i.yg)("h4",{id:"parameters-14"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"ui")," - The ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/"},"custom UI")," to create.")),(0,i.yg)("h4",{id:"returns-15"},"Returns"),(0,i.yg)("p",null,"The interface's ID to be used in ",(0,i.yg)("a",{parentName:"p",href:"#snap_dialog"},(0,i.yg)("inlineCode",{parentName:"a"},"snap_dialog")),", returned from\n",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/entry-points#ontransaction"},(0,i.yg)("inlineCode",{parentName:"a"},"onTransaction"))," or ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/reference/entry-points#onhomepage"},(0,i.yg)("inlineCode",{parentName:"a"},"onHomePage")),"."),(0,i.yg)("h4",{id:"example-17"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="index.js"',title:'"index.js"'},'const interfaceId = await snap.request({\n  method: "snap_createInterface",\n  params: {\n    ui: panel([\n      heading("Interactive interface"),\n      button({\n        value: "Click me",\n        name: "interactive-button",\n      }),\n    ])\n  },\n});\n\nawait snap.request({\n  method: "snap_dialog",\n  params: {\n    type: "Alert",\n    id: interfaceId\n  }\n});\n')),(0,i.yg)("h3",{id:"snap_getinterfacestate"},(0,i.yg)("inlineCode",{parentName:"h3"},"snap_getInterfaceState")),(0,i.yg)("admonition",{type:"flaskOnly"}),(0,i.yg)("p",null,"Gets the state of an interactive interface by its ID.\nFor use in ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/interactive-ui"},"interactive UI"),"."),(0,i.yg)("h4",{id:"parameters-15"},"Parameters"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of the interface.")),(0,i.yg)("h4",{id:"returns-16"},"Returns"),(0,i.yg)("p",null,"An object where each top-level property can be one of the following:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"name")," of an ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/#input"},(0,i.yg)("inlineCode",{parentName:"a"},"input"))," with its current value."),(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"name")," of a ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/#form"},(0,i.yg)("inlineCode",{parentName:"a"},"form")),", with a nested object containing the\ncurrent values of all ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/#input"},(0,i.yg)("inlineCode",{parentName:"a"},"inputs"))," in the form.")),(0,i.yg)("h4",{id:"example-18"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="index.js"',title:'"index.js"'},'const interfaceId = await snap.request({\n  method: "snap_createInterface",\n  params: {\n    ui: panel([\n      heading("Interactive UI Example Snap"),\n      // A top-level input.\n      input({\n        name: "top-level-input",\n        placeholder: "Enter something",\n      }),\n      // A top-level form...\n      form({\n        name: "example-form",\n        children: [\n          // ...with a nested input.\n          input({\n            name: "nested-input",\n            placeholder: "Enter something",\n          }),\n          button("Submit", ButtonType.Submit, "submit"),\n        ],\n      }),\n    ]),\n  },\n});\n\nconst state = await snap.request({\n  method: "snap_getInterfaceState",\n  params: {\n    id: interfaceId,\n  },\n});\n\nconsole.log(state);\n/*\n{\n  "top-level-input": "What the user typed in that field",\n  "example-form": {\n    "nested-input": "What the user typed in that field"\n  }\n}\n*/\n')),(0,i.yg)("h3",{id:"snap_updateinterface"},(0,i.yg)("inlineCode",{parentName:"h3"},"snap_updateInterface")),(0,i.yg)("admonition",{type:"flaskOnly"}),(0,i.yg)("p",null,"Updates an interactive interface.\nFor use in ",(0,i.yg)("a",{parentName:"p",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/interactive-ui"},"interactive UI"),"."),(0,i.yg)("h4",{id:"parameters-16"},"Parameters"),(0,i.yg)("p",null,"An object containing:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"id")," - The ID of the interface to be updated, usually received in the\n",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/reference/entry-points#onuserinput"},(0,i.yg)("inlineCode",{parentName:"a"},"onUserInput"))," entry point."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"ui")," - The ",(0,i.yg)("a",{parentName:"li",href:"/update-react-tutorials-86-mm-detect/snaps/features/custom-ui/"},"custom UI")," to create.")),(0,i.yg)("h4",{id:"example-19"},"Example"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="index.js"',title:'"index.js"'},'export function onUserInput({ id, event }) {\n  console.log("Received input event", event);\n\n  await snap.request({\n    method: "snap_updateInterface",\n    params: {\n      id,\n      ui: panel([\n        heading("New interface"),\n      ]),\n    },\n  });\n};\n')))}g.isMDXComponent=!0},19365:(e,n,t)=>{t.d(n,{A:()=>s});var a=t(96540),i=t(20053);const r={tabItem:"tabItem_Ymn6"};function s(e){let{children:n,hidden:t,className:s}=e;return a.createElement("div",{role:"tabpanel",className:(0,i.A)(r.tabItem,s),hidden:t},n)}},4865:(e,n,t)=>{t.d(n,{A:()=>c});var a=t(58168),i=t(96540),r=t(20053),s=t(23104),l=t(47751),o=t(92303);const p={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function m(e){let{className:n,block:t,selectedValue:l,selectValue:o,tabValues:m}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.a_)(),c=e=>{const n=e.currentTarget,t=u.indexOf(n),a=m[t].value;a!==l&&(d(n),o(a))},g=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=u.indexOf(e.currentTarget)+1;n=u[t]??u[0];break}case"ArrowLeft":{const t=u.indexOf(e.currentTarget)-1;n=u[t]??u[u.length-1];break}}n?.focus()};return i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n)},m.map((e=>{let{value:n,label:t,attributes:s}=e;return i.createElement("li",(0,a.A)({role:"tab",tabIndex:l===n?0:-1,"aria-selected":l===n,key:n,ref:e=>u.push(e),onKeyDown:g,onClick:c},s,{className:(0,r.A)("tabs__item",p.tabItem,s?.className,{"tabs__item--active":l===n})}),t??n)})))}function u(e){let{lazy:n,children:t,selectedValue:a}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===a));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return i.createElement("div",{className:"margin-top--md"},r.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==a}))))}function d(e){const n=(0,l.u)(e);return i.createElement("div",{className:(0,r.A)("tabs-container",p.tabList)},i.createElement(m,(0,a.A)({},e,n)),i.createElement(u,(0,a.A)({},e,n)))}function c(e){const n=(0,o.A)();return i.createElement(d,(0,a.A)({key:String(n)},e))}},47751:(e,n,t)=>{t.d(n,{u:()=>d});var a=t(96540),i=t(56347),r=t(57485),s=t(31682),l=t(89466);function o(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:i}}=e;return{value:n,label:t,attributes:a,default:i}}))}function p(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??o(t);return function(e){const n=(0,s.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function u(e){let{queryString:n=!1,groupId:t}=e;const s=(0,i.W6)(),l=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,r.aZ)(l),(0,a.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(s.location.search);n.set(l,e),s.replace({...s.location,search:n.toString()})}),[l,s])]}function d(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,r=p(e),[s,o]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r}))),[d,c]=u({queryString:t,groupId:i}),[g,y]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,r]=(0,l.Dv)(t);return[i,(0,a.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:i}),h=(()=>{const e=d??g;return m({value:e,tabValues:r})?e:null})();(0,a.useLayoutEffect)((()=>{h&&o(h)}),[h]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),c(e),y(e)}),[c,y,r]),tabValues:r}}}}]);