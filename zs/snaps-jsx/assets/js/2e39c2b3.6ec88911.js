"use strict";(self.webpackChunkmetamask_docs=self.webpackChunkmetamask_docs||[]).push([[4698],{28022:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var t=n(74848),a=n(28453);const r={description:"Use Jest for end-to-end Snap testing.",sidebar_position:6},o="Test a Snap",i={id:"how-to/test-a-snap",title:"Test a Snap",description:"Use Jest for end-to-end Snap testing.",source:"@site/snaps/how-to/test-a-snap.md",sourceDirName:"how-to",slug:"/how-to/test-a-snap",permalink:"/zs/snaps-jsx/snaps/how-to/test-a-snap",draft:!1,unlisted:!1,editUrl:"https://github.com/MetaMask/metamask-docs/edit/main/snaps/how-to/test-a-snap.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{description:"Use Jest for end-to-end Snap testing.",sidebar_position:6},sidebar:"snapsSidebar",previous:{title:"Allow automatic connections",permalink:"/zs/snaps-jsx/snaps/how-to/allow-automatic-connections"},next:{title:"Debug a Snap",permalink:"/zs/snaps-jsx/snaps/how-to/debug-a-snap/"}},c={},p=[{value:"Steps",id:"steps",level:2},{value:"1. Install @metamask/snaps-jest",id:"1-install-metamasksnaps-jest",level:3},{value:"2. Configure @metamask/snaps-jest",id:"2-configure-metamasksnaps-jest",level:3},{value:"3. Use @metamask/snaps-jest",id:"3-use-metamasksnaps-jest",level:3}];function l(s){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"test-a-snap",children:"Test a Snap"}),"\n",(0,t.jsxs)(e.p,{children:["You can test your Snap by hosting it locally using ",(0,t.jsx)(e.code,{children:"yarn start"}),", installing it in Flask, and calling\nits API methods from a dapp."]}),"\n",(0,t.jsxs)(e.p,{children:["For end-to-end Snap testing in a Jest environment, use the\n",(0,t.jsx)(e.a,{href:"https://github.com/MetaMask/snaps/tree/main/packages/snaps-jest",children:(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})})," package\nas follows."]}),"\n",(0,t.jsx)(e.h2,{id:"steps",children:"Steps"}),"\n",(0,t.jsx)(e.h3,{id:"1-install-metamasksnaps-jest",children:"1. Install @metamask/snaps-jest"}),"\n",(0,t.jsxs)(e.p,{children:["Install the ",(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})," package into your Snap project using ",(0,t.jsx)(e.a,{href:"https://yarnpkg.com/",children:"Yarn"}),"\nor ",(0,t.jsx)(e.a,{href:"https://www.npmjs.com/",children:"npm"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"yarn add -D @metamask/snaps-jest\n"})}),"\n",(0,t.jsx)(e.p,{children:"or"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"npm i @metamask/snaps-jest\n"})}),"\n",(0,t.jsx)(e.h3,{id:"2-configure-metamasksnaps-jest",children:"2. Configure @metamask/snaps-jest"}),"\n",(0,t.jsxs)(e.p,{children:["The easiest way to configure this package is to add it to your Jest configuration as a preset.\nIn the ",(0,t.jsx)(e.code,{children:"jest.config.js"})," file, add the following:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",metastring:'title="jest.config.js"',children:'module.exports = {\n  preset: "@metamask/snaps-jest",\n};\n'})}),"\n",(0,t.jsxs)(e.p,{children:["This automatically configures Jest to use the ",(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})," environment, and to use the\n",(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})," matchers.\nYou can then run the ",(0,t.jsx)(e.code,{children:"jest"})," command as usual."]}),"\n",(0,t.jsx)(e.admonition,{type:"note",children:(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})," assumes the Snap is built in the directory you run Jest from.\nIf you use a different directory, you can specify the path using the\n",(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/cli/options#r-root",children:(0,t.jsx)(e.code,{children:"root"})})," option, or by running your own HTTP server.\nIt's currently not possible to use ",(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"})," with a Snap that is not built."]})}),"\n",(0,t.jsxs)(e.p,{children:["If you don't use the package as a preset, you can alternatively add the ",(0,t.jsx)(e.code,{children:"@metamask/snaps-jest"}),"\nenvironment and matchers to your Jest configuration manually:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",metastring:'title="jest.config.js"',children:'module.exports = {\n  testEnvironment: "@metamask/snaps-jest",\n  setupFilesAfterEnv: ["@metamask/snaps-jest/dist/cjs/setup.js"],\n};\n'})}),"\n",(0,t.jsxs)(e.p,{children:["You can pass any ",(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#options",children:"Jest options"})," to the test environment by adding a\n",(0,t.jsx)(e.code,{children:"testEnvironmentOptions"})," property to your Jest configuration.\nFor example:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",metastring:'title="jest.config.js"',children:'module.exports = {\n  preset: "@metamask/snaps-jest",\n  testEnvironmentOptions: {\n    // Options go here.\n  },\n};\n'})}),"\n",(0,t.jsx)(e.p,{children:"All options are optional."}),"\n",(0,t.jsx)(e.h3,{id:"3-use-metamasksnaps-jest",children:"3. Use @metamask/snaps-jest"}),"\n",(0,t.jsxs)(e.p,{children:["Use the package by calling any of the ",(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#api-methods",children:"API methods"}),".\nYou can:"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#installsnap",children:"Install a Snap."})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#sendtransaction",children:"Send a transaction to the Snap."})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#runcronjob",children:"Run a cronjob in the Snap."})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#getinterface",children:"Interact with user interfaces."})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#mock",children:"Mock the response of a network request."})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#close",children:"Close the testing page."})}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["You can also use ",(0,t.jsx)(e.a,{href:"/zs/snaps-jsx/snaps/reference/jest#jest-matchers",children:"Jest matchers"})," to assert that a response from\na Snap matches an expected value."]})]})}function d(s={}){const{wrapper:e}={...(0,a.R)(),...s.components};return e?(0,t.jsx)(e,{...s,children:(0,t.jsx)(l,{...s})}):l(s)}},28453:(s,e,n)=>{n.d(e,{R:()=>o,x:()=>i});var t=n(96540);const a={},r=t.createContext(a);function o(s){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function i(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(a):s.components||a:o(s.components),t.createElement(r.Provider,{value:e},s.children)}}}]);